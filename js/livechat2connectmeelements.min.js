!function(e){var t="",i=null;console.log("livechat2connectmeelements hashData",window.location.hash),t="https://www.2connectme.com",console.log("livechat2connectmeelements runningMode","production",t);var o=function(e){if(!e)return null;try{return new URL(e).origin}catch(e){return picoLog.warn("locationPrefix exception e",e),null}},n=function(e){return o(e)?o(e):t},c={};var a=!1;if("disable"!=livechat2connectme_element.myfixed_element_enable){if(null==livechat2connectme_element.livechat2connectme_disable_at_width_string?c.shopifySmallscreensize="767":c.shopifySmallscreensize=livechat2connectme_element.livechat2connectme_disable_at_width_string,void 0===livechat2connectme_element.myfixed_click_string?c.shopifyChangeevent="click":c.shopifyChangeevent=livechat2connectme_element.myfixed_click_string,livechat2connectme_element.myfixed_element_icon_bg_img.search("small")>=0?c.shopifyIconsize="30":livechat2connectme_element.myfixed_element_icon_bg_img.search("medium")>=0?c.shopifyIconsize="40":(livechat2connectme_element.myfixed_element_icon_bg_img.search("large"),c.shopifyIconsize="50"),null==livechat2connectme_element.myfixed_element_side_position?c.shopifyIconposition="left":c.shopifyIconposition=livechat2connectme_element.myfixed_element_side_position,null==livechat2connectme_element.myfixed_element_icon_bg_img?c.shopifyIcon="/img/chat-large.png":c.shopifyIcon=livechat2connectme_element.myfixed_element_icon_bg_img,c.shopifyIcon.search("whatsapp")>=0?c.shopifyIconcolor="transparent":null==typeof livechat2connectme_element.myfixed_element_icon_bg_color?c.shopifyIconcolor="#0082c8":c.shopifyIconcolor=livechat2connectme_element.myfixed_element_icon_bg_color,null==livechat2connectme_element.myfixed_element_content)c.shopifyIconaction="https://2connectme.com/incorrectCustomerPhone.html";else try{i=new URL(livechat2connectme_element.myfixed_element_content),c.shopifyIconaction=livechat2connectme_element.myfixed_element_content}catch(e){console.log("exception myfixed_element_content",e),c.shopifyIconaction="https://2connectme.com/incorrectCustomerPhone.html"}null==livechat2connectme_element.myfixed_element_content_bg_color?c.shopifyWhisperbackgroundcolor="#F2F2F2":c.shopifyWhisperbackgroundcolor=livechat2connectme_element.myfixed_element_content_bg_color,null==livechat2connectme_element.myfixed_element_content_txt_color?c.shopifyWhispertextcolor="black":c.shopifyWhispertextcolor=livechat2connectme_element.myfixed_element_content_txt_color;var r=document.createElement("div");r.innerHTML=function(e){var i="<style> @media only screen and (max-width:"+e.shopifySmallscreensize+"px) {.livechat2connectme-block-left, .livechat2connectme-block-right, .livechat2connectme-block-left_middle, livechat2connectme-block-right_middle { display: none;border:none; margin:2px; }};  </style>",o='<div class="livechat2connectme-block-'+e.shopifyIconposition+'" style="'+e.shopifyIconposition+":0px; background:"+e.shopifyIconcolor+';">',n='<div class="livechat2connectme-block-'+e.shopifyIconposition+'" style="background:black;">',c='<span class="livechat2connectme-block-icon" style="top:-'+e.shopifyIconsize+"px;width:"+e.shopifyIconsize+"px;height:"+e.shopifyIconsize+"px;background-color:"+e.shopifyIconcolor+"; background-image: url("+t+e.shopifyIcon+');"></span>',a='<span id="iconButtonLeftMiddle" class="livechat2connectme-block-icon" style="width:'+e.shopifyIconsize+"px;height:"+e.shopifyIconsize+"px;background-color:"+e.shopifyIconcolor+"; background-image: url("+t+e.shopifyIcon+');"></span>',r='<span id="iconButtonRightMiddle" class="livechat2connectme-block-icon" style="width:'+e.shopifyIconsize+"px;height:"+e.shopifyIconsize+"px;background-color:"+e.shopifyIconcolor+"; background-image: url("+t+e.shopifyIcon+');"></span>',s='<span id="agentShortText" class="shorttext" style="right:'+e.shopifyIconsize+"px;max-width:calc(100% -"+e.shopifyIconsize+"px); color:"+e.shopifyWhispertextcolor+"; background-color:"+e.shopifyWhisperbackgroundcolor+';"></span>',l='<span id="agentShortText" class="shorttext" style="left:'+e.shopifyIconsize+"px;max-width:calc(100% -"+e.shopifyIconsize+"px); color:"+e.shopifyWhispertextcolor+"; background-color:"+e.shopifyWhisperbackgroundcolor+';"></span>',h='<span id="agentShortText" class="shorttext" style="color:'+e.shopifyWhispertextcolor+"; background-color:"+e.shopifyWhisperbackgroundcolor+';"></span>',d='<span id="agentShortText" class="shorttext" style="color:'+e.shopifyWhispertextcolor+"; background-color:"+e.shopifyWhisperbackgroundcolor+';"></span>',m='<div class="livechat2connectme-block-content" style="min-height:'+e.shopifyIconsize+'px;"><iframe id="2connectme-content" loading="eager" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"  data-ifsrc="'+e.shopifyIconaction+'"> </iframe> ',u='<img class="livechat2connectme-block-maxwindow-icon" id="maxwindow-icon">',p='<img class="livechat2connectme-block-minwindow-icon" id="minwindow-icon">',f=" </div> </div>";return"left"==e.shopifyIconposition?i+o+c+l+m+u+p+f:"right"==e.shopifyIconposition?i+o+c+s+m+u+p+f:"left_middle"==e.shopifyIconposition?i+n+a+h+m+u+p+f:"right_middle"==e.shopifyIconposition?i+n+r+d+m+u+p+f:void 0}(c),document.body.appendChild(r);var s="";"left_middle"===c.shopifyIconposition||"right_middle"===c.shopifyIconposition?(s=".livechat2connectme-block-left_middle  {position:fixed;box-sizing: border-box; z-index:2147483647;top:50%;left:-100%;  transform: translate(0, -50%)} ",s+=".livechat2connectme-block-right_middle  {position:fixed;box-sizing: border-box; z-index:2147483647;top:50%;right:-100%;  transform: translate(0, -50%)} ",s+=".shorttext {width:max-content; max-width:50%; border-radius: 3px;box-shadow: 0 0 6px #B2B2B2;position:absolute;} .livechat2connectme-block-content p { margin: 5px; } ",s+=".livechat2connectme-block-content div { position: relative; width: 100%; height: 100%; } ",s+=".livechat2connectme-block-content hr { margin-bottom: 5px; }  .livechat2connectme-block-content img { margin: 5px; } ",s+=".livechat2connectme-block-content a {} ",s+=".livechat2connectme-block-icon {;background-position: center; background-repeat: no-repeat;cursor: hand;} ",s+=".livechat2connectme-block-left_middle .livechat2connectme-block-icon {left:calc(100% + 5px); top:50%;position: absolute; transform: translate(0, -50%); border-radius:3px;} ",s+=".livechat2connectme-block-right_middle .livechat2connectme-block-icon  {right:100%; top:50%;position: absolute; transform: translate(0, -50%); border-radius:3px;} "):(s=".livechat2connectme-block-left, .livechat2connectme-block-right {position: fixed; z-index:2147483647;width: 400px;bottom:-100%;margin:5;padding:0} ",s+=".shorttext {border-radius: 3px; box-shadow: 0 0 6px #B2B2B2;position:absolute;} ",s+=".livechat2connectme-block-content p { margin: 0; } ",s+=".livechat2connectme-block-content div { position: relative; width: 100%; height: 100%; } ",s+=".livechat2connectme-block-content hr { margin-bottom: 7px; }  ",s+=".livechat2connectme-block-content img { margin: 5px 0; } .livechat2connectme-block-content a {} ",s+=".livechat2connectme-block-icon {background-position: center; background-repeat: no-repeat;cursor: hand;} ",s+=".livechat2connectme-block-left .livechat2connectme-block-icon {left:0px; position: absolute; absolute;border-radius:3px;}  ",s+=".livechat2connectme-block-right .livechat2connectme-block-icon {right: 0px; position: absolute;border-radius:3px;} ");var l=document.createElement("style");l.type="text/css",l.styleSheet?l.styleSheet.cssText=s.toString():l.appendChild(document.createTextNode(s)),document.getElementsByTagName("head")[0].appendChild(l),e("#maxwindow-icon").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAABpklEQVRoQ+2a7TEEQRCGn4sAESASREAGyIAIEAEiQAZEQCZHBkRAvWqnam7q7G7PXXXNrZ4/9+N6bt6P6dm96Z4xkTGbCA+WETkErgB9tjiegXvgLQdXErnuSLRIoMR0Awjv78iJyIFX4KsLeAQ+G2O0DZx1+LaAo+RMTkRWHQCXwF1jBEo4F8At8AKclI58d9E7DTpREtkD5vmuyh1JRDblJFvAG0QayKFwRMfzA6BE8xjvwHn54MsWrnZEp4QXiYRXZPb/UK2aiPepNrReEEkKeORH3/tg+m5lRyZDxOvJHzliUsBhf5nwWN61hn543dyG1ls52SNHjJaFIyYFjOrWhJvwRLLXSGycE46YFDCqWxNuwhM5UiOxcU44YlLAqG5NuAlP5EiNxMY54ciQAqqVqCbhOT567tKq/4/oplHFn10nJiKhos5CiW0dN41O+EcvU+3I6BWcAoOIk9Cjl/k/jmx8MVQdBcdTKE+nhgE9+NRR8NRgmVoNA6dZH8DShgFl2SRaONJxIWfUWaBt1uJQt4M6M3qbaloEPgqT1z3uKDCrBP0AZdSiM/o7g3cAAAAASUVORK5CYII="),e("#maxwindow-icon").attr("style","position:absolute;top:0px;right:0px;display:block;"),e("#maxwindow-icon").attr("width","30"),e("#maxwindow-icon").attr("height","30"),e("#minwindow-icon").attr("src","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAABfUlEQVRoQ+2a0TEFQRBFz4sAESASREAGyIAIEAEiQAZEQCbIgAioq3arZqee97a69FTv6v7Zn52Zvn1m5mP6LphJLGaig2VC9oELQN+I8QjcAi9lcrWQy05ERAF1TleA8v2JUogIPAOf3Q/3wEcwRZvASZffBnDQkymFCNUecA7cBBNQp3MGXANPwFFN5Kv7eysgiVrIDvBa7qqSSC9kKjfZIN8UEuAMJZEAEAYpJJEk4lSB3FpOhTVPm0TMpXMamEScCmueNomYS+c0MIk4FdY8bRIxl85pYBJxKqx52iRiLp3TwCTiVFjztElEr/V3gN5dW8QbcFr3QYqFzUT0aNxKRJ+vxOz+UjWzkNaP3OvWSyHqXqlL1DLeV2xnMxEddrXjthspkQi12QZNz7847I3yH72MmcjoFRr9+H+ETL4ZKkfB4Rza071hQNesHAUPAdvUMgwcFz6ApYYBndFZWDj6y0Zk5CzQNosYcjvImbHSVBMx8VE5TcXlsFbMN8OyejMgrAjWAAAAAElFTkSuQmCC"),e("#minwindow-icon").attr("style","position:absolute;top:0px;right:35px;display:block;"),e("#minwindow-icon").attr("width","30"),e("#minwindow-icon").attr("height","30"),e("#2connectme-content").attr("allow","microphone; camera"),e("#2connectme-content").attr("scrolling","yes"),e("#2connectme-content").attr("width","100%");console.log("Business Chat Room - 2ConnectMe html plugin ver","1.6.9","production");var h=c.shopifySmallscreensize.toString();myfixed_click=c.shopifyChangeevent.toString();var d=parseInt(document.body.clientWidth),m=0,u=0,p=!1,f=e(".livechat2connectme-block-icon").css("background-image"),v=e("#2connectme-content").attr("data-ifsrc"),g=e("#2connectme-content")[0],b=g.contentWindow?g.contentWindow:g.contentDocument.defaultView,y=(e("#2connectme-content").parent().parent().height(),null),k="INIT",w=null,C=null;e(window).on("focus",function(){R({type:"WP_VISIBILITY",msg:"WP_FOCUS"})}),e(window).on("blur",function(){R({type:"WP_VISIBILITY",msg:"WP_BLUR"})}),e(window).on("click",function(e){R({type:"WP_CLICK",msg:{event:e.target.href}})}),e(window).resize(function(){"MAX"==k&&_(),d=parseInt(document.body.clientWidth),R(C?{type:"WP_CONTACTFORM_WIDTH",mirrorClient:"true",msg:{bodyWidth:d,widthDisableScreen:h,screenSize:{height:e(window).height().toString(),width:e(window).width().toString()}}}:{type:"WP_CONTACTFORM_WIDTH",mirrorClient:"false",msg:{bodyWidth:d,widthDisableScreen:h,screenSize:{height:e(window).height().toString(),width:e(window).width().toString()}}})}),e(window).scroll(function(t){if(C){var i=e(window).scrollTop().toString(),o=e(window).scrollLeft().toString();R({type:"WP_SCROLL",mirrorClient:"true",msg:{yScroll:i,xScroll:o}})}});var N=function(t){e("#agentShortText").text(t);var i;"right_middle"!=c.shopifyIconposition?"left_middle"!=c.shopifyIconposition?(i=0-e("#agentShortText").height(),e("#agentShortText").css({top:i})):e("#agentShortText").css({top:e("#iconButtonLeftMiddle").position().top+Number(c.shopifyIconsize),left:e("#iconButtonLeftMiddle").position().left+5}):e("#agentShortText").css({top:e("#iconButtonRightMiddle").position().top+Number(c.shopifyIconsize),left:e("#iconButtonRightMiddle").position().left+Number(c.shopifyIconsize)-e("#agentShortText").width()-5})},_=function(t,i){var o=e(window).height(),n=e(window).width();t&&(o=t),i&&(n=i),"left"!==c.shopifyIconposition&&"right"!==c.shopifyIconposition||(w.animate({height:o,width:n}),e("#2connectme-content").animate({height:o,width:n})),"left_middle"!==c.shopifyIconposition&&"right_middle"!==c.shopifyIconposition||(w.animate({height:o,width:n,bottom:0}),e("#2connectme-content").animate({height:o,width:n,bottom:0,top:0})),k="MAX",R({type:"WP_CONTACTFORM_SCREEN",msg:"FULL_SCREEN"})},E=function(){return k="RESTORED","left"===c.shopifyIconposition?(e(".livechat2connectme-block-left").stop().animate({bottom:0,height:m,width:u}),e("#2connectme-content").animate({height:m-5,width:u}),void R({type:"WP_CONTACTFORM_SCREEN",msg:"FULL_SCREEN_EXIT"})):"right"===c.shopifyIconposition?(a=!0,e(".livechat2connectme-block-right").stop().animate({bottom:0,height:m,width:u},function(){a=!1}),e("#2connectme-content").animate({height:m-5,width:u}),void R({type:"WP_CONTACTFORM_SCREEN",msg:"FULL_SCREEN_EXIT"})):"left_middle"===c.shopifyIconposition?(e(".livechat2connectme-block-left_middle").stop().animate({left:0,height:m,width:u}),e("#2connectme-content").animate({height:m-5,width:u}),void R({type:"WP_CONTACTFORM_SCREEN",msg:"FULL_SCREEN_EXIT"})):"right_middle"===c.shopifyIconposition?(e(".livechat2connectme-block-right_middle").stop().animate({right:0,height:m,width:u}),e("#2connectme-content").animate({height:m-5,width:u}),void R({type:"WP_CONTACTFORM_SCREEN",msg:"FULL_SCREEN_EXIT"})):void 0},I=function(e){"MAX"==k?(e.height(),e.width(),E()):(m=e.height(),u=e.width(),_())},M=function(e){"MAX"!==k&&(m=e.height(),u=e.width(),_())},A=function(e){"RESTORED"!==k&&(e.height(),e.width(),E())},O=function(t){if(T(),!D()){if("left_middle"===t)return e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").hasClass("mse-open")?P(!0):(w=e(".livechat2connectme-block-left_middle"),P(!1)),void e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").toggleClass("mse-open");if("left"!==t){if("right_middle"===t)return e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").hasClass("mse-open")?P(!0):(w=e(".livechat2connectme-block-right_middle"),P(!1)),void e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").toggleClass("mse-open");if("right"!==t)console.error("chatIconClickHandler unrecognised iconPosition",t);else{if(e(".livechat2connectme-block-right .livechat2connectme-block-icon").hasClass("mse-open")){i=e(".livechat2connectme-block-right .livechat2connectme-block-icon").parent().height();e(".livechat2connectme-block-right .livechat2connectme-block-icon").parent().stop().animate({bottom:0-i},R({type:"WP_CONTACTFORM",msg:"closed"}))}else w=e(".livechat2connectme-block-right"),m!=w.height()&&u!=w.width()&&0!=m&0!=u&&(w.css("height",e(window).height()),w.css("width",e(window).width()),e("#2connectme-content").css("height",e(window).height()),e("#2connectme-content").css("width",e(window).width())),e(".livechat2connectme-block-right .livechat2connectme-block-icon").parent().stop().animate({bottom:"0px"},R({type:"WP_CONTACTFORM",msg:"opened"}));e(".livechat2connectme-block-right .livechat2connectme-block-icon").toggleClass("mse-open")}}else{if(e(".livechat2connectme-block-left .livechat2connectme-block-icon").hasClass("mse-open")){var i=e(".livechat2connectme-block-left .livechat2connectme-block-icon").parent().height();e(".livechat2connectme-block-left .livechat2connectme-block-icon").parent().stop().animate({bottom:0-i},R({type:"WP_CONTACTFORM",msg:"closed"}))}else w=e(".livechat2connectme-block-left"),m!=w.height()&&u!=w.width()&&0!=m&0!=u&&(w.css("height",e(window).height()),w.css("width",e(window).width()),e("#2connectme-content").css("height",e(window).height()),e("#2connectme-content").css("width",e(window).width())),e(".livechat2connectme-block-left .livechat2connectme-block-icon").parent().stop().animate({bottom:"0px"},R({type:"WP_CONTACTFORM",msg:"opened"}));e(".livechat2connectme-block-left .livechat2connectme-block-icon").toggleClass("mse-open")}}},S={Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return S.Android()||S.BlackBerry()||S.iOS()||S.Opera()||S.Windows()}},T=function(){p=!0,D()&&x()},x=function(){null==y?y=window.open(v,"_blank","left=0,top=0,height=350,width=420,location=no"):y.closed?y=window.open(v,"_blank","left=0,top=0,height=350,width=420,location=no"):y.focus()},D=function(){return f.search("phone")>=0||f.search("video")>=0?"https:"!=window.location.protocol||("SAFARI"==("undefined"==typeof navigator?"OTHER_BROWSERS":navigator.mozGetUserMedia?"FIREFOX":navigator.webkitGetUserMedia?"CHROME":window.navigator.userAgent.indexOf("Edge")>-1?"EDGE":window.navigator.userAgent.indexOf("Safari")>-1?"SAFARI":"OTHER_BROWSERS")||!!S.iOS()):!!S.iOS()},R=function(e){void 0!==b&&b.postMessage(e,n(i.href))},P=function(t){if(N(""),"left_middle"===c.shopifyIconposition)return t?e(".livechat2connectme-block-left_middle").stop().animate({left:-5-e(".livechat2connectme-block-left_middle").width()},R({type:"WP_CONTACTFORM",msg:"closed"})):e(".livechat2connectme-block-left_middle").stop().animate({left:0},R({type:"WP_CONTACTFORM",msg:"opened"})),void e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").css({display:"block"});if("right_middle"===c.shopifyIconposition)return t?e(".livechat2connectme-block-right_middle").stop().animate({right:-0-e(".livechat2connectme-block-right_middle").width()},R({type:"WP_CONTACTFORM",msg:"closed"})):e(".livechat2connectme-block-right_middle").stop().animate({right:0},R({type:"WP_CONTACTFORM",msg:"opened"})),void e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").css({display:"block"});if(t){var i=e("#2connectme-content").parent().parent().height();e("#2connectme-content").parent().parent().css("bottom",0-i)}else{i=e("#2connectme-content").parent().parent().height();e("#2connectme-content").parent().parent().css("bottom",0)}};null!=e("#2connectme-content").attr("src")&&0!=e("#2connectme-content").attr("src").length||e("#2connectme-content").attr("src",v+"#PARENT_URL:"+document.location.href),P(!0);var W=window.addEventListener?"addEventListener":"attachEvent";(0,window[W])("attachEvent"==W?"onmessage":"message",function(t){if(void 0!==t.data.split){var i=t.data.split(":");if("wpFrameSize"===i[0]){var o=Number(i[2])+5;return Number(i[2])>=e(window).height()&&(o=e(window).height()+5),"left_middle"===c.shopifyIconposition||"right_middle"===c.shopifyIconposition?("left_middle"===c.shopifyIconposition&&(p?e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-left_middle").css({width:i[1],height:o}):e(".livechat2connectme-block-left_middle").css({left:-5-Number(i[1]),width:i[1],height:o})),"right_middle"===c.shopifyIconposition&&(p?e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-right_middle").css({width:i[1],height:o}):e(".livechat2connectme-block-right_middle").css({right:-0-Number(i[1]),width:i[1],height:o})),e("#2connectme-content").css({width:i[1],height:o-5}),void e(".livechat2connectme-block-icon").css({display:"block"})):("left"===c.shopifyIconposition&&(p?e(".livechat2connectme-block-left .livechat2connectme-block-icon").hasClass("mse-open")?e(".livechat2connectme-block-left").css({bottom:0,width:i[1],height:o}):console.log("eventer left touched block-left !mse-open"):e(".livechat2connectme-block-left").css({bottom:0-o,width:i[1],height:o})),"right"===c.shopifyIconposition&&(p?e(".livechat2connectme-block-right .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-right").css({bottom:0,width:i[1],height:o}):e(".livechat2connectme-block-right").css({bottom:0-o,width:i[1],height:o})),e("#2connectme-content").css({width:i[1],height:o-5}),void e(".livechat2connectme-block-icon").css({display:"block"}))}if("wpIconClick"===i[0])return e(".livechat2connectme-block-right .livechat2connectme-block-icon").click(),void e(".livechat2connectme-block-left .livechat2connectme-block-icon").click();if("openContactForm"===i[0])return"left"===c.shopifyIconposition&&(e(".livechat2connectme-block-left .livechat2connectme-block-icon").hasClass("mse-open")||e(".livechat2connectme-block-left .livechat2connectme-block-icon").click()),"right"===c.shopifyIconposition&&(e(".livechat2connectme-block-right .livechat2connectme-block-icon").hasClass("mse-open")||e(".livechat2connectme-block-right .livechat2connectme-block-icon").click()),"left_middle"===c.shopifyIconposition&&(e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").hasClass("mse-open")||e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").click()),void("right_middle"===c.shopifyIconposition&&(e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").hasClass("mse-open")||e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").click()));if("closeContactForm"===i[0])return"left"===c.shopifyIconposition&&e(".livechat2connectme-block-left .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-left .livechat2connectme-block-icon").click(),"right"===c.shopifyIconposition&&e(".livechat2connectme-block-right .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-right .livechat2connectme-block-icon").click(),"left_middle"===c.shopifyIconposition&&e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").click(),void("right_middle"===c.shopifyIconposition&&e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").hasClass("mse-open")&&e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").click());if("wpVer"===i[0])return console.log("eventer wpVer received wpVersion","1.6.9"),void R({type:"WP_VER",msg:{wpVer:"1.6.9",wpIframeSrc:v,referrer:document.location.href}});if("wpBodyWidth"===i[0])return void R({type:"WP_CONTACTFORM_WIDTH",msg:{bodyWidth:d,widthDisableScreen:h}});if("agentSendCustText"===i[0])return void N(i[1]);if("startMi"===i[0])return R({type:"MI_BASE",msg:{base:location.href.match(/^(.*\/)[^\/]*$/)[1],screenSize:{height:e(window).height().toString(),width:e(window).width().toString()}}}),void(C=new TreeMirrorClient(document,{initialize:function(e,t){R({type:"MI_INIT",msg:{f:"initialize",args:[e,t]}})},applyChanged:function(e,t,i,o){R({type:"MI_CHANGED",msg:{f:"applyChanged",args:[e,t,i,o]}})}}));if("stopMi"===i[0])return C&&C.disconnect(),void(C=null);if("hideMaxMinWindowIcon"===i[0])return e("#maxwindow-icon").hide(),void e("#minwindow-icon").hide();if("maxWindowContent"===i[0])return"left_middle"===c.shopifyIconposition?void I(e(".livechat2connectme-block-left_middle")):"right_middle"===c.shopifyIconposition?void I(e(".livechat2connectme-block-right_middle")):"left"===c.shopifyIconposition?void I(e(".livechat2connectme-block-left")):"right"===c.shopifyIconposition?void I(e(".livechat2connectme-block-right")):void console.error("maxWindowContent unrecognised chat icon position",c.shopifyIconposition);if("minWindowContent"===i[0])return"left_middle"===c.shopifyIconposition?void O("left_middle"):"right_middle"===c.shopifyIconposition?void O("right_middle"):"left"===c.shopifyIconposition?void O("left"):"right"===c.shopifyIconposition?void O("right"):void console.error("minWindowContent unrecognised chat icon position",c.shopifyIconposition);if("fullScreenWindowContent"===i[0])return"left_middle"===c.shopifyIconposition?void M(e(".livechat2connectme-block-left_middle")):"right_middle"===c.shopifyIconposition?void M(e(".livechat2connectme-block-right_middle")):"left"===c.shopifyIconposition?void M(e(".livechat2connectme-block-left")):"right"===c.shopifyIconposition?void M(e(".livechat2connectme-block-right")):void console.error("fullScreenWindowContent unrecognised chat icon position",c.shopifyIconposition);if("restoreScreenWindowContent"===i[0])return"left_middle"===c.shopifyIconposition?void A(e(".livechat2connectme-block-left_middle")):"right_middle"===c.shopifyIconposition?void A(e(".livechat2connectme-block-right_middle")):"left"===c.shopifyIconposition?void A(e(".livechat2connectme-block-left")):"right"===c.shopifyIconposition?void A(e(".livechat2connectme-block-right")):void console.error("restoreScreenWindowContent unrecognised chat icon position",c.shopifyIconposition)}},!1),e("#2connectme-content").on("load",function(){var t=e("#2connectme-content").parent().parent().height(),i=e("#2connectme-content").parent().parent().width();(f.search("chat.png")>=0||f.search("chat-medium.png")>=0||f.search("chat-large.png")>=0||f.search("chat-small.png")>=0||f.search("mail")>=0)&&("left"===c.shopifyIconposition||"right"===c.shopifyIconposition?e("#2connectme-content").parent().parent().css("bottom",0-t):"left_middle"===c.shopifyIconposition?e("#2connectme-content").parent().parent().css({left:-5-i,height:t}):"right_middle"===c.shopifyIconposition&&e("#2connectme-content").parent().parent().css({right:-5-i,height:t}))}),d>=h&&("hover"!=myfixed_click&&"click"!=myfixed_click||(e(".livechat2connectme-block-left_middle .livechat2connectme-block-content .livechat2connectme-block-maxwindow-icon").click(function(){I(e(".livechat2connectme-block-left_middle"))}),e(".livechat2connectme-block-left .livechat2connectme-block-content .livechat2connectme-block-maxwindow-icon").click(function(){I(e(".livechat2connectme-block-left"))}),e(".livechat2connectme-block-left .livechat2connectme-block-content .livechat2connectme-block-minwindow-icon").click(function(){O("left")}),e(".livechat2connectme-block-left_middle .livechat2connectme-block-content .livechat2connectme-block-minwindow-icon").click(function(){O("left_middle")}),e(".livechat2connectme-block-right .livechat2connectme-block-content .livechat2connectme-block-maxwindow-icon").click(function(){I(e(".livechat2connectme-block-right"))}),e(".livechat2connectme-block-right_middle .livechat2connectme-block-content .livechat2connectme-block-maxwindow-icon").click(function(){I(e(".livechat2connectme-block-right_middle"))}),e(".livechat2connectme-block-right .livechat2connectme-block-content .livechat2connectme-block-minwindow-icon").click(function(){O("right")}),e(".livechat2connectme-block-right_middle .livechat2connectme-block-content .livechat2connectme-block-minwindow-icon").click(function(){O("right_middle")})),"hover"==myfixed_click&&(e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").mouseover(function(){T(),D()||e(this).hasClass("mse-open")||(e(this).addClass("mse-open"),w=e(".livechat2connectme-block-left_middle"),P(!1))}),e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").click(function(){O("left_middle")}),e(".livechat2connectme-block-left .livechat2connectme-block-icon").mouseover(function(){T(),D()||e(this).hasClass("mse-open")||(e(this).addClass("mse-open"),w=e(".livechat2connectme-block-left"),m!=w.height()&&u!=w.width()&&0!=m&0!=u&&(w.css("height",e(window).height()),w.css("width",e(window).width()),e("#2connectme-content").css("height",e(window).height()),e("#2connectme-content").css("width",e(window).width())),e(this).parent().stop().animate({bottom:"0px"},R({type:"WP_CONTACTFORM",msg:"opened"})))}),e(".livechat2connectme-block-left .livechat2connectme-block-icon").click(function(){O("left")}),e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").mouseover(function(){T(),D()||e(this).hasClass("mse-open")||(e(this).addClass("mse-open"),w=e(".livechat2connectme-block-right_middle"),P(!1))}),e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").click(function(){O("right_middle")}),e(".livechat2connectme-block-right .livechat2connectme-block-icon").mouseover(function(){a||(T(),D()||e(this).hasClass("mse-open")||(e(this).addClass("mse-open"),w=e(".livechat2connectme-block-right"),m!=w.height()&&u!=w.width()&&0!=m&0!=u&&(w.css("height",e(window).height()),w.css("width",e(window).width()),e("#2connectme-content").css("height",e(window).height()),e("#2connectme-content").css("width",e(window).width())),e(this).parent().stop().animate({bottom:"0px"},R({type:"WP_CONTACTFORM",msg:"opened"}))))}),e(".livechat2connectme-block-right .livechat2connectme-block-icon").click(function(){O("right")})),"click"==myfixed_click&&(e(".livechat2connectme-block-left_middle .livechat2connectme-block-icon").click(function(){O("left_middle")}),e(".livechat2connectme-block-left .livechat2connectme-block-icon").click(function(){O("left")}),e(".livechat2connectme-block-right_middle .livechat2connectme-block-icon").click(function(){O("right_middle")}),e(".livechat2connectme-block-right .livechat2connectme-block-icon").click(function(){O("right")})))}}(jQuery);var MutationObserverCtor,__extends=this.__extends||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);function o(){this.constructor=e}o.prototype=t.prototype,e.prototype=new o};if(void 0===(MutationObserverCtor="undefined"!=typeof WebKitMutationObserver?WebKitMutationObserver:MutationObserver))throw console.error("DOM Mutation Observers are required."),Error("DOM Mutation Observers are required");var Movement,NodeMap=function(){function e(){this.nodes=[],this.values=[]}return e.prototype.isIndex=function(e){return+e==e>>>0},e.prototype.nodeId=function(t){var i=t[e.ID_PROP];return i||(i=t[e.ID_PROP]=e.nextId_++),i},e.prototype.set=function(e,t){var i=this.nodeId(e);this.nodes[i]=e,this.values[i]=t},e.prototype.get=function(e){var t=this.nodeId(e);return this.values[t]},e.prototype.has=function(e){return this.nodeId(e)in this.nodes},e.prototype.delete=function(e){var t=this.nodeId(e);delete this.nodes[t],this.values[t]=void 0},e.prototype.keys=function(){var e=[];for(var t in this.nodes)this.isIndex(t)&&e.push(this.nodes[t]);return e},e.ID_PROP="__mutation_summary_node_map_id__",e.nextId_=1,e}();function enteredOrExited(e){return e===Movement.ENTERED||e===Movement.EXITED}!function(e){e[e.STAYED_OUT=0]="STAYED_OUT",e[e.ENTERED=1]="ENTERED",e[e.STAYED_IN=2]="STAYED_IN",e[e.REPARENTED=3]="REPARENTED",e[e.REORDERED=4]="REORDERED",e[e.EXITED=5]="EXITED"}(Movement||(Movement={}));var NodeChange=function(){function e(e,t,i,o,n,c,a,r){void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===n&&(n=null),void 0===c&&(c=!1),void 0===a&&(a=null),void 0===r&&(r=null),this.node=e,this.childList=t,this.attributes=i,this.characterData=o,this.oldParentNode=n,this.added=c,this.attributeOldValues=a,this.characterDataOldValue=r,this.isCaseInsensitive=this.node.nodeType===Node.ELEMENT_NODE&&this.node instanceof HTMLElement&&this.node.ownerDocument instanceof HTMLDocument}return e.prototype.getAttributeOldValue=function(e){if(this.attributeOldValues)return this.isCaseInsensitive&&(e=e.toLowerCase()),this.attributeOldValues[e]},e.prototype.getAttributeNamesMutated=function(){var e=[];if(!this.attributeOldValues)return e;for(var t in this.attributeOldValues)e.push(t);return e},e.prototype.attributeMutated=function(e,t){this.attributes=!0,this.attributeOldValues=this.attributeOldValues||{},e in this.attributeOldValues||(this.attributeOldValues[e]=t)},e.prototype.characterDataMutated=function(e){this.characterData||(this.characterData=!0,this.characterDataOldValue=e)},e.prototype.removedFromParent=function(e){this.childList=!0,this.added||this.oldParentNode?this.added=!1:this.oldParentNode=e},e.prototype.insertedIntoParent=function(){this.childList=!0,this.added=!0},e.prototype.getOldParent=function(){if(this.childList){if(this.oldParentNode)return this.oldParentNode;if(this.added)return null}return this.node.parentNode},e}(),ChildListChange=function(){return function(){this.added=new NodeMap,this.removed=new NodeMap,this.maybeMoved=new NodeMap,this.oldPrevious=new NodeMap,this.moved=void 0}}(),TreeChanges=function(e){function t(t,i){e.call(this),this.rootNode=t,this.reachableCache=void 0,this.wasReachableCache=void 0,this.anyParentsChanged=!1,this.anyAttributesChanged=!1,this.anyCharacterDataChanged=!1;for(var o=0;o<i.length;o++){var n=i[o];switch(n.type){case"childList":this.anyParentsChanged=!0;for(var c=0;c<n.removedNodes.length;c++){var a=n.removedNodes[c];this.getChange(a).removedFromParent(n.target)}for(c=0;c<n.addedNodes.length;c++){a=n.addedNodes[c];this.getChange(a).insertedIntoParent()}break;case"attributes":this.anyAttributesChanged=!0,this.getChange(n.target).attributeMutated(n.attributeName,n.oldValue);break;case"characterData":this.anyCharacterDataChanged=!0,this.getChange(n.target).characterDataMutated(n.oldValue)}}}return __extends(t,e),t.prototype.getChange=function(e){var t=this.get(e);return t||(t=new NodeChange(e),this.set(e,t)),t},t.prototype.getOldParent=function(e){var t=this.get(e);return t?t.getOldParent():e.parentNode},t.prototype.getIsReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.reachableCache=this.reachableCache||new NodeMap;var t=this.reachableCache.get(e);return void 0===t&&(t=this.getIsReachable(e.parentNode),this.reachableCache.set(e,t)),t},t.prototype.getWasReachable=function(e){if(e===this.rootNode)return!0;if(!e)return!1;this.wasReachableCache=this.wasReachableCache||new NodeMap;var t=this.wasReachableCache.get(e);return void 0===t&&(t=this.getWasReachable(this.getOldParent(e)),this.wasReachableCache.set(e,t)),t},t.prototype.reachabilityChange=function(e){return this.getIsReachable(e)?this.getWasReachable(e)?Movement.STAYED_IN:Movement.ENTERED:this.getWasReachable(e)?Movement.EXITED:Movement.STAYED_OUT},t}(NodeMap),MutationProjection=function(){function e(e,t,i,o,n){this.rootNode=e,this.mutations=t,this.selectors=i,this.calcReordered=o,this.calcOldPreviousSibling=n,this.treeChanges=new TreeChanges(e,t),this.entered=[],this.exited=[],this.stayedIn=new NodeMap,this.visited=new NodeMap,this.childListChangeMap=void 0,this.characterDataOnly=void 0,this.matchCache=void 0,this.processMutations()}return e.prototype.processMutations=function(){if(this.treeChanges.anyParentsChanged||this.treeChanges.anyAttributesChanged)for(var e=this.treeChanges.keys(),t=0;t<e.length;t++)this.visitNode(e[t],void 0)},e.prototype.visitNode=function(e,t){if(!this.visited.has(e)){this.visited.set(e,!0);var i=this.treeChanges.get(e),o=t;if((i&&i.childList||void 0==o)&&(o=this.treeChanges.reachabilityChange(e)),o!==Movement.STAYED_OUT){if(this.matchabilityChange(e),o===Movement.ENTERED)this.entered.push(e);else if(o===Movement.EXITED)this.exited.push(e),this.ensureHasOldPreviousSiblingIfNeeded(e);else if(o===Movement.STAYED_IN){var n=Movement.STAYED_IN;i&&i.childList&&(i.oldParentNode!==e.parentNode?(n=Movement.REPARENTED,this.ensureHasOldPreviousSiblingIfNeeded(e)):this.calcReordered&&this.wasReordered(e)&&(n=Movement.REORDERED)),this.stayedIn.set(e,n)}if(o!==Movement.STAYED_IN)for(var c=e.firstChild;c;c=c.nextSibling)this.visitNode(c,o)}}},e.prototype.ensureHasOldPreviousSiblingIfNeeded=function(e){if(this.calcOldPreviousSibling){this.processChildlistChanges();var t=e.parentNode,i=this.treeChanges.get(e);i&&i.oldParentNode&&(t=i.oldParentNode);var o=this.childListChangeMap.get(t);o||(o=new ChildListChange,this.childListChangeMap.set(t,o)),o.oldPrevious.has(e)||o.oldPrevious.set(e,e.previousSibling)}},e.prototype.getChanged=function(e,t,i){this.selectors=t,this.characterDataOnly=i;for(var o=0;o<this.entered.length;o++){var n=this.entered[o];(r=this.matchabilityChange(n))!==Movement.ENTERED&&r!==Movement.STAYED_IN||e.added.push(n)}var c=this.stayedIn.keys();for(o=0;o<c.length;o++){n=c[o];if((r=this.matchabilityChange(n))===Movement.ENTERED)e.added.push(n);else if(r===Movement.EXITED)e.removed.push(n);else if(r===Movement.STAYED_IN&&(e.reparented||e.reordered)){var a=this.stayedIn.get(n);e.reparented&&a===Movement.REPARENTED?e.reparented.push(n):e.reordered&&a===Movement.REORDERED&&e.reordered.push(n)}}for(o=0;o<this.exited.length;o++){var r;n=this.exited[o];(r=this.matchabilityChange(n))!==Movement.EXITED&&r!==Movement.STAYED_IN||e.removed.push(n)}},e.prototype.getOldParentNode=function(e){var t=this.treeChanges.get(e);if(t&&t.childList)return t.oldParentNode?t.oldParentNode:null;var i=this.treeChanges.reachabilityChange(e);if(i===Movement.STAYED_OUT||i===Movement.ENTERED)throw Error("getOldParentNode requested on invalid node.");return e.parentNode},e.prototype.getOldPreviousSibling=function(e){var t=e.parentNode,i=this.treeChanges.get(e);i&&i.oldParentNode&&(t=i.oldParentNode);var o=this.childListChangeMap.get(t);if(!o)throw Error("getOldPreviousSibling requested on invalid node.");return o.oldPrevious.get(e)},e.prototype.getOldAttribute=function(e,t){var i=this.treeChanges.get(e);if(!i||!i.attributes)throw Error("getOldAttribute requested on invalid node.");var o=i.getAttributeOldValue(t);if(void 0===o)throw Error("getOldAttribute requested for unchanged attribute name.");return o},e.prototype.attributeChangedNodes=function(e){if(!this.treeChanges.anyAttributesChanged)return{};var t,i;if(e){t={},i={};for(var o=0;o<e.length;o++){t[d=e[o]]=!0,i[d.toLowerCase()]=d}}var n={},c=this.treeChanges.keys();for(o=0;o<c.length;o++){var a=c[o],r=this.treeChanges.get(a);if(r.attributes&&(Movement.STAYED_IN===this.treeChanges.reachabilityChange(a)&&Movement.STAYED_IN===this.matchabilityChange(a)))for(var s=a,l=r.getAttributeNamesMutated(),h=0;h<l.length;h++){var d=l[h];if(!t||t[d]||r.isCaseInsensitive&&i[d])r.getAttributeOldValue(d)!==s.getAttribute(d)&&(i&&r.isCaseInsensitive&&(d=i[d]),n[d]=n[d]||[],n[d].push(s))}}return n},e.prototype.getOldCharacterData=function(e){var t=this.treeChanges.get(e);if(!t||!t.characterData)throw Error("getOldCharacterData requested on invalid node.");return t.characterDataOldValue},e.prototype.getCharacterDataChanged=function(){if(!this.treeChanges.anyCharacterDataChanged)return[];for(var e=this.treeChanges.keys(),t=[],i=0;i<e.length;i++){var o=e[i];if(Movement.STAYED_IN===this.treeChanges.reachabilityChange(o)){var n=this.treeChanges.get(o);n.characterData&&o.textContent!=n.characterDataOldValue&&t.push(o)}}return t},e.prototype.computeMatchabilityChange=function(e,t){this.matchCache||(this.matchCache=[]),this.matchCache[e.uid]||(this.matchCache[e.uid]=new NodeMap);var i=this.matchCache[e.uid],o=i.get(t);return void 0===o&&(o=e.matchabilityChange(t,this.treeChanges.get(t)),i.set(t,o)),o},e.prototype.matchabilityChange=function(e){var t=this;if(this.characterDataOnly)switch(e.nodeType){case Node.COMMENT_NODE:case Node.TEXT_NODE:return Movement.STAYED_IN;default:return Movement.STAYED_OUT}if(!this.selectors)return Movement.STAYED_IN;if(e.nodeType!==Node.ELEMENT_NODE)return Movement.STAYED_OUT;for(var i=e,o=this.selectors.map(function(e){return t.computeMatchabilityChange(e,i)}),n=Movement.STAYED_OUT,c=0;n!==Movement.STAYED_IN&&c<o.length;){switch(o[c]){case Movement.STAYED_IN:n=Movement.STAYED_IN;break;case Movement.ENTERED:n=n===Movement.EXITED?Movement.STAYED_IN:Movement.ENTERED;break;case Movement.EXITED:n=n===Movement.ENTERED?Movement.STAYED_IN:Movement.EXITED}c++}return n},e.prototype.getChildlistChange=function(e){var t=this.childListChangeMap.get(e);return t||(t=new ChildListChange,this.childListChangeMap.set(e,t)),t},e.prototype.processChildlistChanges=function(){if(!this.childListChangeMap){this.childListChangeMap=new NodeMap;for(var e=0;e<this.mutations.length;e++){var t=this.mutations[e];if("childList"==t.type&&(this.treeChanges.reachabilityChange(t.target)===Movement.STAYED_IN||this.calcOldPreviousSibling)){for(var i=this.getChildlistChange(t.target),o=t.previousSibling,n=0;n<t.removedNodes.length;n++){a(c=t.removedNodes[n],o),i.added.has(c)?i.added.delete(c):(i.removed.set(c,!0),i.maybeMoved.delete(c)),o=c}a(t.nextSibling,o);for(n=0;n<t.addedNodes.length;n++){var c=t.addedNodes[n];i.removed.has(c)?(i.removed.delete(c),i.maybeMoved.set(c,!0)):i.added.set(c,!0)}}function a(e,t){!e||i.oldPrevious.has(e)||i.added.has(e)||i.maybeMoved.has(e)||t&&(i.added.has(t)||i.maybeMoved.has(t))||i.oldPrevious.set(e,t)}}}},e.prototype.wasReordered=function(e){if(!this.treeChanges.anyParentsChanged)return!1;this.processChildlistChanges();var t=e.parentNode,i=this.treeChanges.get(e);i&&i.oldParentNode&&(t=i.oldParentNode);var o=this.childListChangeMap.get(t);if(!o)return!1;if(o.moved)return o.moved.get(e);o.moved=new NodeMap;var n=new NodeMap;function c(e){if(!e)return!1;if(!o.maybeMoved.has(e))return!1;var t=o.moved.get(e);return void 0!==t?t:(n.has(e)?t=!0:(n.set(e,!0),t=function(e){if(r.has(e))return r.get(e);var t=e.previousSibling;for(;t&&(o.added.has(t)||c(t));)t=t.previousSibling;return r.set(e,t),t}(e)!==function e(t){var i=a.get(t);if(void 0!==i)return i;i=o.oldPrevious.get(t);for(;i&&(o.removed.has(i)||c(i));)i=e(i);void 0===i&&(i=t.previousSibling);a.set(t,i);return i}(e)),n.has(e)?(n.delete(e),o.moved.set(e,t)):t=o.moved.get(e),t)}var a=new NodeMap;var r=new NodeMap;return o.maybeMoved.keys().forEach(c),o.moved.get(e)},e}(),Summary=function(){function e(e,t){var i=this;if(this.projection=e,this.added=[],this.removed=[],this.reparented=t.all||t.element||t.characterData?[]:void 0,this.reordered=t.all?[]:void 0,e.getChanged(this,t.elementFilter,t.characterData),t.all||t.attribute||t.attributeList){var o=t.attribute?[t.attribute]:t.attributeList,n=e.attributeChangedNodes(o);t.attribute?this.valueChanged=n[t.attribute]||[]:(this.attributeChanged=n,t.attributeList&&t.attributeList.forEach(function(e){i.attributeChanged.hasOwnProperty(e)||(i.attributeChanged[e]=[])}))}if(t.all||t.characterData){var c=e.getCharacterDataChanged();t.characterData?this.valueChanged=c:this.characterDataChanged=c}this.reordered&&(this.getOldPreviousSibling=e.getOldPreviousSibling.bind(e))}return e.prototype.getOldParentNode=function(e){return this.projection.getOldParentNode(e)},e.prototype.getOldAttribute=function(e,t){return this.projection.getOldAttribute(e,t)},e.prototype.getOldCharacterData=function(e){return this.projection.getOldCharacterData(e)},e.prototype.getOldPreviousSibling=function(e){return this.projection.getOldPreviousSibling(e)},e}(),validNameInitialChar=/[a-zA-Z_]+/,validNameNonInitialChar=/[a-zA-Z0-9_\-]+/;function escapeQuotes(e){return'"'+e.replace(/"/,'\\"')+'"'}var Qualifier=function(){function e(){}return e.prototype.matches=function(e){if(null===e)return!1;if(void 0===this.attrValue)return!0;if(!this.contains)return this.attrValue==e;for(var t=e.split(" "),i=0;i<t.length;i++)if(this.attrValue===t[i])return!0;return!1},e.prototype.toString=function(){return"class"===this.attrName&&this.contains?"."+this.attrValue:"id"!==this.attrName||this.contains?this.contains?"["+this.attrName+"~="+escapeQuotes(this.attrValue)+"]":"attrValue"in this?"["+this.attrName+"="+escapeQuotes(this.attrValue)+"]":"["+this.attrName+"]":"#"+this.attrValue},e}(),Selector=function(){function e(){this.uid=e.nextUid++,this.qualifiers=[]}var t;return Object.defineProperty(e.prototype,"caseInsensitiveTagName",{get:function(){return this.tagName.toUpperCase()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"selectorString",{get:function(){return this.tagName+this.qualifiers.join("")},enumerable:!0,configurable:!0}),e.prototype.isMatching=function(t){return t[e.matchesSelector](this.selectorString)},e.prototype.wasMatching=function(e,t,i){if(!t||!t.attributes)return i;var o=t.isCaseInsensitive?this.caseInsensitiveTagName:this.tagName;if("*"!==o&&o!==e.tagName)return!1;for(var n=[],c=!1,a=0;a<this.qualifiers.length;a++){var r=this.qualifiers[a],s=t.getAttributeOldValue(r.attrName);n.push(s),c=c||void 0!==s}if(!c)return i;for(a=0;a<this.qualifiers.length;a++){r=this.qualifiers[a];if(void 0===(s=n[a])&&(s=e.getAttribute(r.attrName)),!r.matches(s))return!1}return!0},e.prototype.matchabilityChange=function(e,t){var i=this.isMatching(e);return i?this.wasMatching(e,t,i)?Movement.STAYED_IN:Movement.ENTERED:this.wasMatching(e,t,i)?Movement.EXITED:Movement.STAYED_OUT},e.parseSelectors=function(t){var i,o,n=[];function c(){i&&(o&&(i.qualifiers.push(o),o=void 0),n.push(i)),i=new e}function a(){o&&i.qualifiers.push(o),o=new Qualifier}for(var r,s=/\s/,l="Invalid or unsupported selector syntax.",h=1,d=0;d<t.length;){var m=t[d++];switch(h){case 1:if(m.match(validNameInitialChar)){c(),i.tagName=m,h=2;break}if("*"==m){c(),i.tagName="*",h=3;break}if("."==m){c(),a(),i.tagName="*",o.attrName="class",o.contains=!0,h=4;break}if("#"==m){c(),a(),i.tagName="*",o.attrName="id",h=4;break}if("["==m){c(),a(),i.tagName="*",o.attrName="",h=6;break}if(m.match(s))break;throw Error(l);case 2:if(m.match(validNameNonInitialChar)){i.tagName+=m;break}if("."==m){a(),o.attrName="class",o.contains=!0,h=4;break}if("#"==m){a(),o.attrName="id",h=4;break}if("["==m){a(),o.attrName="",h=6;break}if(m.match(s)){h=14;break}if(","==m){h=1;break}throw Error(l);case 3:if("."==m){a(),o.attrName="class",o.contains=!0,h=4;break}if("#"==m){a(),o.attrName="id",h=4;break}if("["==m){a(),o.attrName="",h=6;break}if(m.match(s)){h=14;break}if(","==m){h=1;break}throw Error(l);case 4:if(m.match(validNameInitialChar)){o.attrValue=m,h=5;break}throw Error(l);case 5:if(m.match(validNameNonInitialChar)){o.attrValue+=m;break}if("."==m){a(),o.attrName="class",o.contains=!0,h=4;break}if("#"==m){a(),o.attrName="id",h=4;break}if("["==m){a(),h=6;break}if(m.match(s)){h=14;break}if(","==m){h=1;break}throw Error(l);case 6:if(m.match(validNameInitialChar)){o.attrName=m,h=7;break}if(m.match(s))break;throw Error(l);case 7:if(m.match(validNameNonInitialChar)){o.attrName+=m;break}if(m.match(s)){h=8;break}if("~"==m){o.contains=!0,h=9;break}if("="==m){o.attrValue="",h=11;break}if("]"==m){h=3;break}throw Error(l);case 8:if("~"==m){o.contains=!0,h=9;break}if("="==m){o.attrValue="",h=11;break}if("]"==m){h=3;break}if(m.match(s))break;throw Error(l);case 9:if("="==m){o.attrValue="",h=11;break}throw Error(l);case 10:if("]"==m){h=3;break}if(m.match(s))break;throw Error(l);case 11:if(m.match(s))break;if('"'==m||"'"==m){r=m,h=13;break}o.attrValue+=m,h=12;break;case 12:if(m.match(s)){h=10;break}if("]"==m){h=3;break}if("'"==m||'"'==m)throw Error(l);o.attrValue+=m;break;case 13:if(m==r){h=10;break}o.attrValue+=m;break;case 14:if(m.match(s))break;if(","==m){h=1;break}throw Error(l)}}switch(h){case 1:case 2:case 3:case 5:case 14:c();break;default:throw Error(l)}if(!n.length)throw Error(l);return n},e.nextUid=1,e.matchesSelector="function"==typeof(t=document.createElement("div")).webkitMatchesSelector?"webkitMatchesSelector":"function"==typeof t.mozMatchesSelector?"mozMatchesSelector":"function"==typeof t.msMatchesSelector?"msMatchesSelector":"matchesSelector",e}(),attributeFilterPattern=/^([a-zA-Z:_]+[a-zA-Z0-9_\-:\.]*)$/;function validateAttribute(e){if("string"!=typeof e)throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!(e=e.trim()))throw Error("Invalid request opion. attribute must be a non-zero length string.");if(!e.match(attributeFilterPattern))throw Error("Invalid request option. invalid attribute name: "+e);return e}function validateElementAttributes(e){if(!e.trim().length)throw Error("Invalid request option: elementAttributes must contain at least one attribute.");for(var t={},i={},o=e.split(/\s+/),n=0;n<o.length;n++){if(c=o[n]){var c,a=(c=validateAttribute(c)).toLowerCase();if(t[a])throw Error("Invalid request option: observing multiple case variations of the same attribute is not supported.");i[c]=!0,t[a]=!0}}return Object.keys(i)}function elementFilterAttributes(e){var t={};return e.forEach(function(e){e.qualifiers.forEach(function(e){t[e.attrName]=!0})}),Object.keys(t)}var MutationSummary=function(){function e(t){var i=this;this.connected=!1,this.options=e.validateOptions(t),this.observerOptions=e.createObserverOptions(this.options.queries),this.root=this.options.rootNode,this.callback=this.options.callback,this.elementFilter=Array.prototype.concat.apply([],this.options.queries.map(function(e){return e.elementFilter?e.elementFilter:[]})),this.elementFilter.length||(this.elementFilter=void 0),this.calcReordered=this.options.queries.some(function(e){return e.all}),this.queryValidators=[],e.createQueryValidator&&(this.queryValidators=this.options.queries.map(function(t){return e.createQueryValidator(i.root,t)})),this.observer=new MutationObserverCtor(function(e){i.observerCallback(e)}),this.reconnect()}return e.createObserverOptions=function(e){var t,i={childList:!0,subtree:!0};function o(e){i.attributes&&!t||(i.attributes=!0,i.attributeOldValue=!0,e?(t=t||{},e.forEach(function(e){t[e]=!0,t[e.toLowerCase()]=!0})):t=void 0)}return e.forEach(function(e){if(e.characterData)return i.characterData=!0,void(i.characterDataOldValue=!0);if(e.all)return o(),i.characterData=!0,void(i.characterDataOldValue=!0);if(e.attribute)o([e.attribute.trim()]);else{var t=elementFilterAttributes(e.elementFilter).concat(e.attributeList||[]);t.length&&o(t)}}),t&&(i.attributeFilter=Object.keys(t)),i},e.validateOptions=function(t){for(var i in t)if(!(i in e.optionKeys))throw Error("Invalid option: "+i);if("function"!=typeof t.callback)throw Error("Invalid options: callback is required and must be a function");if(!t.queries||!t.queries.length)throw Error("Invalid options: queries must contain at least one query request object.");for(var o={callback:t.callback,rootNode:t.rootNode||document,observeOwnChanges:!!t.observeOwnChanges,oldPreviousSibling:!!t.oldPreviousSibling,queries:[]},n=0;n<t.queries.length;n++){var c=t.queries[n];if(c.all){if(Object.keys(c).length>1)throw Error("Invalid request option. all has no options.");o.queries.push({all:!0})}else if("attribute"in c){if((r={attribute:validateAttribute(c.attribute)}).elementFilter=Selector.parseSelectors("*["+r.attribute+"]"),Object.keys(c).length>1)throw Error("Invalid request option. attribute has no options.");o.queries.push(r)}else if("element"in c){var a=Object.keys(c).length,r={element:c.element,elementFilter:Selector.parseSelectors(c.element)};if(c.hasOwnProperty("elementAttributes")&&(r.attributeList=validateElementAttributes(c.elementAttributes),a--),a>1)throw Error("Invalid request option. element only allows elementAttributes option.");o.queries.push(r)}else{if(!c.characterData)throw Error("Invalid request option. Unknown query request.");if(Object.keys(c).length>1)throw Error("Invalid request option. characterData has no options.");o.queries.push({characterData:!0})}}return o},e.prototype.createSummaries=function(e){if(!e||!e.length)return[];for(var t=new MutationProjection(this.root,e,this.elementFilter,this.calcReordered,this.options.oldPreviousSibling),i=[],o=0;o<this.options.queries.length;o++)i.push(new Summary(t,this.options.queries[o]));return i},e.prototype.checkpointQueryValidators=function(){this.queryValidators.forEach(function(e){e&&e.recordPreviousState()})},e.prototype.runQueryValidators=function(e){this.queryValidators.forEach(function(t,i){t&&t.validate(e[i])})},e.prototype.changesToReport=function(e){return e.some(function(e){if(["added","removed","reordered","reparented","valueChanged","characterDataChanged"].some(function(t){return e[t]&&e[t].length}))return!0;if(e.attributeChanged&&Object.keys(e.attributeChanged).some(function(t){return!!e.attributeChanged[t].length}))return!0;return!1})},e.prototype.observerCallback=function(e){this.options.observeOwnChanges||this.observer.disconnect();var t=this.createSummaries(e);this.runQueryValidators(t),this.options.observeOwnChanges&&this.checkpointQueryValidators(),this.changesToReport(t)&&this.callback(t),!this.options.observeOwnChanges&&this.connected&&(this.checkpointQueryValidators(),this.observer.observe(this.root,this.observerOptions))},e.prototype.reconnect=function(){if(this.connected)throw Error("Already connected");this.observer.observe(this.root,this.observerOptions),this.connected=!0,this.checkpointQueryValidators()},e.prototype.takeSummaries=function(){if(!this.connected)throw Error("Not connected");var e=this.createSummaries(this.observer.takeRecords());return this.changesToReport(e)?e:void 0},e.prototype.disconnect=function(){var e=this.takeSummaries();return this.observer.disconnect(),this.connected=!1,e},e.NodeMap=NodeMap,e.parseElementFilter=Selector.parseSelectors,e.optionKeys={callback:!0,queries:!0,rootNode:!0,oldPreviousSibling:!0,observeOwnChanges:!0},e}(),TreeMirror=function(){function e(e,t){this.root=e,this.delegate=t,this.idMap={}}return e.prototype.initialize=function(e,t){this.idMap[e]=this.root;for(var i=0;i<t.length;i++)this.deserializeNode(t[i],this.root)},e.prototype.applyChanged=function(e,t,i,o){var n=this;t.forEach(function(e){var t=n.deserializeNode(e);n.deserializeNode(e.parentNode),n.deserializeNode(e.previousSibling);t.parentNode&&t.parentNode.removeChild(t)}),e.forEach(function(e){var t=n.deserializeNode(e);t.parentNode&&t.parentNode.removeChild(t)}),t.forEach(function(e){var t=n.deserializeNode(e),i=n.deserializeNode(e.parentNode),o=n.deserializeNode(e.previousSibling);i.insertBefore(t,o?o.nextSibling:i.firstChild)}),i.forEach(function(e){var t=n.deserializeNode(e);Object.keys(e.attributes).forEach(function(i){var o=e.attributes[i];null===o?t.removeAttribute(i):n.delegate&&n.delegate.setAttribute&&n.delegate.setAttribute(t,i,o)||t.setAttribute(i,o)})}),o.forEach(function(e){n.deserializeNode(e).textContent=e.textContent}),e.forEach(function(e){delete n.idMap[e.id]})},e.prototype.deserializeNode=function(e,t){var i=this;if(null===e)return null;var o=this.idMap[e.id];if(o)return o;var n=this.root.ownerDocument;switch(null===n&&(n=this.root),e.nodeType){case Node.COMMENT_NODE:o=n.createComment(e.textContent);break;case Node.TEXT_NODE:o=n.createTextNode(e.textContent);break;case Node.DOCUMENT_TYPE_NODE:o=n.implementation.createDocumentType(e.name,e.publicId,e.systemId);break;case Node.ELEMENT_NODE:this.delegate&&this.delegate.createElement&&(o=this.delegate.createElement(e.tagName)),o||(o=n.createElement(e.tagName)),Object.keys(e.attributes).forEach(function(t){i.delegate&&i.delegate.setAttribute&&i.delegate.setAttribute(o,t,e.attributes[t])||o.setAttribute(t,e.attributes[t])})}if(!o)throw"ouch";if(this.idMap[e.id]=o,t&&t.appendChild(o),e.childNodes)for(var c=0;c<e.childNodes.length;c++)this.deserializeNode(e.childNodes[c],o);return o},e}(),TreeMirrorClient=function(){function e(e,t,i){var o=this;this.target=e,this.mirror=t,this.nextId=1,this.knownNodes=new MutationSummary.NodeMap;for(var n=this.serializeNode(e).id,c=[],a=e.firstChild;a;a=a.nextSibling)c.push(this.serializeNode(a,!0));this.mirror.initialize(n,c);var r=[{all:!0}];i&&(r=r.concat(i)),this.mutationSummary=new MutationSummary({rootNode:e,callback:function(e){o.applyChanged(e)},queries:r})}return e.prototype.disconnect=function(){this.mutationSummary&&(this.mutationSummary.disconnect(),this.mutationSummary=void 0)},e.prototype.rememberNode=function(e){var t=this.nextId++;return this.knownNodes.set(e,t),t},e.prototype.forgetNode=function(e){this.knownNodes.delete(e)},e.prototype.serializeNode=function(e,t){if(null===e)return null;var i=this.knownNodes.get(e);if(void 0!==i)return{id:i};var o={nodeType:e.nodeType,id:this.rememberNode(e)};switch(o.nodeType){case Node.DOCUMENT_TYPE_NODE:var n=e;o.name=n.name,o.publicId=n.publicId,o.systemId=n.systemId;break;case Node.COMMENT_NODE:case Node.TEXT_NODE:o.textContent=e.textContent;break;case Node.ELEMENT_NODE:var c=e;o.tagName=c.tagName,o.attributes={};for(var a=0;a<c.attributes.length;a++){var r=c.attributes[a];o.attributes[r.name]=r.value}if(t&&c.childNodes.length){o.childNodes=[];for(var s=c.firstChild;s;s=s.nextSibling)o.childNodes.push(this.serializeNode(s,!0))}}return o},e.prototype.serializeAddedAndMoved=function(e,t,i){var o=this,n=e.concat(t).concat(i),c=new MutationSummary.NodeMap;n.forEach(function(e){var t=e.parentNode,i=c.get(t);i||(i=new MutationSummary.NodeMap,c.set(t,i)),i.set(e,!0)});var a=[];return c.keys().forEach(function(e){for(var t=c.get(e),i=t.keys();i.length;){for(var n=i[0];n.previousSibling&&t.has(n.previousSibling);)n=n.previousSibling;for(;n&&t.has(n);){var r=o.serializeNode(n);r.previousSibling=o.serializeNode(n.previousSibling),r.parentNode=o.serializeNode(n.parentNode),a.push(r),t.delete(n),n=n.nextSibling}i=t.keys()}}),a},e.prototype.serializeAttributeChanges=function(e){var t=this,i=new MutationSummary.NodeMap;return Object.keys(e).forEach(function(o){e[o].forEach(function(e){var n=i.get(e);n||((n=t.serializeNode(e)).attributes={},i.set(e,n)),n.attributes[o]=e.getAttribute(o)})}),i.keys().map(function(e){return i.get(e)})},e.prototype.applyChanged=function(e){var t=this,i=e[0],o=i.removed.map(function(e){return t.serializeNode(e)}),n=this.serializeAddedAndMoved(i.added,i.reparented,i.reordered),c=this.serializeAttributeChanges(i.attributeChanged),a=i.characterDataChanged.map(function(e){var i=t.serializeNode(e);return i.textContent=e.textContent,i});this.mirror.applyChanged(o,n,c,a),i.removed.forEach(function(e){t.forgetNode(e)})},e}();